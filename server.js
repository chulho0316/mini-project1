require('dotenv').config();
//dotenv ì„¤ì • ì¶”ê°€
const express = require('express'); //expressëŠ” node.jsë¡œ ì„œë²„ ë§Œë“¤ë•Œ ê°€ì¥ ë§ì´
//ì“°ëŠ” **í”„ë ˆì„ì›Œí¬(ê¸°ë°˜ë„êµ¬)** , HTTP ìš”ì²­/ì‘ë‹µì„ ì‰½ê²Œ ì²˜ë¦¬í•´ì¤Œ
const cors = require('cors'); // CORS(Cross-Origin Resource Sharing)
// : ë‹¤ë¥¸ í¬íŠ¸, ë„ë©”ì¸ì—ì„œ ì´ ì„œë²„ì— ìš”ì²­ì„ ë³´ë‚¼ ìˆ˜ ìˆë„ë¡ í—ˆìš©í•´ì£¼ëŠ” ê¸°ëŠ¥.
//í”„ë¡ íŠ¸ì—”ë“œê°€ localhost:5173 ì´ê³ , ë°±ì—”ë“œê°€ localhost:3000ì¼ë•Œ í¬íŠ¸ê°€ ë‹¤ë¥´ê¸° ë•Œë¬¸ì—
//cors ì„¤ì •ì´ ì—†ìœ¼ë©´ ë§‰í˜

const app = express(); //appì€ ìš°ë¦¬ê°€ ë§Œë“œëŠ” ì›¹ ì„œë²„ ìì²´ ì´ appì„ í†µí•´ ëª¨ë“  ìš”ì²­/ì‘ë‹µ, ê²½ë¡œ ì„¤ì • ë“±ì„ ì²˜ë¦¬
const port = 3000; //ìš°ë¦¬ ì„œë²„ê°€ ì‹¤í–‰ë  í¬íŠ¸ ë²ˆí˜¸,ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ì£¼ì†Œì°½ì— http://localhost:3000ì´ë¼ê³  ì ‘ì† ê°€ëŠ¥

app.use(cors()); //appì´ ê°ì²´, corsë¥¼ ë¯¸ë“¤ì›¨ì–´ë¡œ ë“±ë¡. ë¯¸ë“¤ì›¨ì–´:ìš”ì²­(req)ê³¼ ì‘ë‹µ(res)ì‚¬ì´ì—ì„œ
//ë™ì‘í•˜ëŠ” í•¨ìˆ˜ ì´ê²½ìš°ëŠ”: í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ì„ CORS í—ˆìš©í•¨.
app.use(express.json()); //ì´ê²ƒ ì—­ì‹œë„ ë¯¸ë“¤ì›¨ì–´. ì˜ë¯¸ëŠ” ë“¤ì–´ì˜¤ëŠ” json ìš”ì²­ ë°”ë””ë¥¼
//ìë™ìœ¼ë¡œ js ê°ì²´ë¡œ ë°”ê¿”ì¤Œ

const userRouter = require('./User/user'); // íšŒì›ê°€ì…/ë¡œê·¸ì¸ ê¸°ëŠ¥ì„ ë”°ë¡œ ë¼ìš°í„°ë¡œ
//ë§Œë“¤ê¸° ìœ„í•´ ë¶ˆëŸ¬ì˜¨ ë¶€ë¶„, user.js ë¼ìš°í„° íŒŒì¼ì—ì„œ ê²½ë¡œë³„ ê¸°ëŠ¥ì„ ë§Œë“¦
app.use('/user', userRouter); // ìœ ì €ë¼ìš°í„°ê°€ ë‹´ë‹¹í•˜ëŠ” ëª¨ë“  ë¼ìš°íŠ¸ ê²½ë¡œ ì•ì— /userë¥¼
//ë¶™ì´ê² ë‹¤. POST/user/register ë˜ëŠ” GET / user /list ê°™ì€ APIê²½ë¡œ

const path = require('path'); // ğŸ“¦ ê²½ë¡œ ì²˜ë¦¬ìš© ëª¨ë“ˆ ì¶”ê°€
app.use(express.static(path.join(__dirname, 'public'))); // ğŸ“ public í´ë” ë‚´ ì •ì  íŒŒì¼ ì œê³µ

if (require.main === module) {
  app.listen(port, () => {
    console.log(`server running on http://localhost:${port}`);
  });
}

module.exports = app; // í…ŒìŠ¤íŠ¸ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ë‚´ë³´ëƒ„
